80

建議重點回饋：建議改用 double 計算並以通用的 3x3 逆矩陣公式，輸出時對於為零的元素改為輸出 0，並補充程式標頭與註解以提升可讀性與維護性。

程式改動說明與重點
- 改用 double 進行矩陣與計算，避免整數除法與溢位風險，並以 det 的近似值判斷是否為零。
- 使用標準的 3x3 逆矩陣公式計算逆矩陣，更易於理解與正確性檢驗。
- 輸出格式調整：若元素絕對值接近於零，輸出 0；否則輸出四位小數，且每行元素以空白分隔，且每行結尾無多餘空白。
- 新增程式標頭註解與適當的程式內註解，提高可讀性與可維護性。

優化後的完整程式碼
- 檔案名稱建議：Inverse3x3.java
- 類別名稱：Inverse3x3

/*
檔案名稱: Inverse3x3.java
功能說明: 讀入 3x3 矩陣，輸出其反矩陣，若行列式為 0 則輸出無反矩陣訊息；非零元素輸出到小數點後四位，若值為零則直接輸出 0。
作者: 你的教師
日期: 2025-11-14
*/

import java.util.Scanner;

public class Inverse3x3 {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        double[][] a = new double[3][3];

        // 讀入 3x3 矩陣
        for (int i = 0; i < 3; i++) {
            for (int j = 0; j < 3; j++) {
                if (sc.hasNextDouble()) {
                    a[i][j] = sc.nextDouble();
                } else {
                    a[i][j] = 0;
                }
            }
        }
        sc.close();

        // 計算行列式 (double 以提升穩定性)
        double det = a[0][0] * (a[1][1] * a[2][2] - a[1][2] * a[2][1])
                   - a[0][1] * (a[1][0] * a[2][2] - a[1][2] * a[2][0])
                   + a[0][2] * (a[1][0] * a[2][1] - a[1][1] * a[2][0]);

        if (Math.abs(det) < 1e-12) {
            System.out.println("此矩陣無反矩陣（行列式為 0）");
            return;
        }

        // 計算逆矩陣，使用常見的 3x3 逆矩陣公式
        double[][] inv = new double[3][3];
        inv[0][0] =  (a[1][1] * a[2][2] - a[1][2] * a[2][1]) / det;
        inv[0][1] =  (a[0][2] * a[2][1] - a[0][1] * a[2][2]) / det;
        inv[0][2] =  (a[0][1] * a[1][2] - a[0][2] * a[1][1]) / det;

        inv[1][0] =  (a[1][2] * a[2][0] - a[1][0] * a[2][2]) / det;
        inv[1][1] =  (a[0][0] * a[2][2] - a[0][2] * a[2][0]) / det;
        inv[1][2] =  (a[0][2] * a[1][0] - a[0][0] * a[1][2]) / det;

        inv[2][0] =  (a[1][0] * a[2][1] - a[1][1] * a[2][0]) / det;
        inv[2][1] =  (a[0][1] * a[2][0] - a[0][0] * a[2][1]) / det;
        inv[2][2] =  (a[0][0] * a[1][1] - a[0][1] * a[1][0]) / det;

        // 輸出：若值接近於零，輸出 0；否則輸出四位小數
        for (int i = 0; i < 3; i++) {
            for (int j = 0; j < 3; j++) {
                double v = inv[i][j];
                if (Math.abs(v) < 1e-9) {
                    System.out.print("0");
                } else {
                    System.out.printf("%.4f", v);
                }
                if (j < 2) System.out.print(" ");
            }
            if (i < 2) System.out.println();
        }
    }
}