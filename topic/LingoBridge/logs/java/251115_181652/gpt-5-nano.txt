30

建議改進：需要移除不必要的 tol 輸入與無法編譯的多餘程式碼，改用兩階段計算以符合題意，並確保輸出格式與內容符合要求。

改進建議與評分說明
- 正確性 (50 分)：原始程式因為含有未封裝的輸出、需要輸入 tol、以及可能的編譯錯誤，無法可靠地輸出題目要求的結果。修正後的版本會按照題意輸出指定的 i 與 pi，並找出最小的 i 使 pi 接近 3.14159，因此正確性評分較低但可有效提升。建議改進前 5 分，改為 15 分。
- 邏輯 (30 分)：原程式的核心是勒貝尼茲級數，但在結尾有未封裝的輸出、需要輸入、以及分段的輸出與新需求不一致，邏輯上仍然正確的方向性，但實作不完整。修正後，邏輯清晰地分成兩部分：(a) 計算並輸出 10000 ~ 100000 的 pi 值；(b) 找到最小的 i 使 pi 與 3.14159 的絕對誤差小於 0.000005。評分可從 12 分提升至 22 分。
- 格式 (10 分)：原始程式有不符合題意的輸出格式與不一致的命名風格，且有未在類中定義的多餘語句。修正後的版本採用清晰的命名、正確的輸出格式與適當的註解，分數可由 4 分提升至 9 分。
- 備註 (10 分)：原始程式缺少適當的標頭註解，且程式內容對於檔案名稱、功能、作者、日期等描述不足。修正後提供完整的檔案註解與說明，評分可由 4 分提升至 8 分。

總評分：30/100

修改說明與優化重點
- 移除輸入 tol 的需求，改為兩段式計算：一段輸出 i 為 10000、20000、…、100000 的 pi 值；一段從頭計算直到找到使 |pi - 3.14159| <= 0.000005 的最小 i。
- 消除編譯錯誤：刪除額外不在方法中的輸出語句，並使用正規的 Java 類與 main 方法。
- 輸出格式嚴格遵循題目要求：i 顯示為 6 位寬，pi 顯示至小數點後 10 位；兩部分之間插入單一空白行。
- 增加檔案註解：提供檔案名稱、功能、作者與日期等註解，以符合備註要求。
- 程式結構與命名改善：使用清晰的變數名稱與可閱讀的程式結構，便於維護與評分。

修改後的完整程式碼如下
/* 
Filename: PiApproximation.java
功能: 使用莱布尼茲級數近似圓周率，輸出 i=10000, 20000, ..., 100000 對應的 pi 值，並找出使 pi 最接近 3.14159 的最小 i。
作者: 教師
日期: 2025-11-15
*/

public class PiApproximation {
    public static void main(String[] args) {
        final double TARGET_PI = 3.14159;
        final double EPS = 0.000005; // 允許的誤差，用於決定 pi 是否足夠接近 TARGET_PI
        double sum = 0.0;

        // (a) 輸出 i = 10000, 20000, ..., 100000 對應的 pi 值
        for (int i = 1; i <= 100000; i++) {
            sum += ((i % 2 == 1) ? 1.0 : -1.0) / (2 * i - 1);
            if (i % 10000 == 0) {
                double pi = 4.0 * sum;
                System.out.printf("i = %6d, pi = %.10f%n", i, pi);
            }
        }

        // 空行分隔
        System.out.println();

        // (b) 找到最小的 i 使 pi 與 3.14159 的絕對誤差 <= 0.000005
        // 為避免累積浮點誤差太大，重新從頭開始計算累加
        sum = 0.0;
        int i = 0;
        double pi = 0.0;
        while (true) {
            i++;
            sum += ((i % 2 == 1) ? 1.0 : -1.0) / (2 * i - 1);
            pi = 4.0 * sum;
            if (Math.abs(pi - TARGET_PI) <= EPS) {
                System.out.printf("i = %6d%n", i);
                break;
            }
            // 安全保護：避免無窮迴圈
            if (i > 2000000) {
                System.out.println("未在允許範圍內找到滿足條件的 i");
                break;
            }
        }
    }
}
