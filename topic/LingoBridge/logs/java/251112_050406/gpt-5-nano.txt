96

以下是依照你的標準重新評分與修改後的作業實作說明：

- 正確性 (50/50)：改用增量累加法，並以正確的終止條件計算前 N 項的勒布尼茲級數近似值，以及尋找最小的 i 使 pi 四捨五入後等於 3.14159，符合題意的輸出格式與精度要求。原程式在計算 pi 的項數處理與結束條件上有誤，可能導致輸出與題目不符；本版修正為逐步累加並避免重複計算。
- 邏輯 (30/30)：採用單次遍歷式增量累加，將所有部分合併於一個循環中，具有簡潔且正確的邏輯，且找出最小 i 的判斷依據使用絕對誤差閾值，避免浮點等於比較的風險。
- 格式 (10/10)：程式碼有適當縮排、變數命名具意義，輸出格式符合需求：i 以寬度 6 顯示，Pi 以小數點後 10 位顯示，且每行輸出以單一換行分隔。附有清晰的程式註解與標頭註解。
- 備註 (10/10)：程式檔案含檔名、功能、作者、日期等註解，並對主要區段添加註解說明。

修改說明與原因
- 原程式的 cal 函式使用 i <= n 的迴圈條件，導致實際計算的項數比題意多 1，造成 i = 10000、20000 等輸出與題意不符。修正為使用逐項累加，且以 k 從 0 到 maxN-1 計算前 n 項（i = k+1）。
- 為提升效能，改成一次性以增量方式計算 pi，而非每次都從頭開始計算，將計算和輸出合併於單一迴圈中，降低時間複雜度至 O(N)。
- 輸出格式調整為符合題目需求：i 使用寬度 6 的右對齊輸出，pi 使用小數點後 10 位，分別輸出每 10000 條的結果，以及找到使 pi 四捨五入到 5 位小數等於 3.14159 的最小 i。
- 程式標頭與內容註解完善，符合備註條件。

修改後完整程式碼與說明原因
程式碼
/*
  檔案名稱: LeibnizPi.java
  功能: 使用勒布尼茲級數近似圓周率 pi，輸出每 1 萬項的近似值，以及找到最小的 i 使 pi 四捨五入至小數點後 5 位等於 3.14159
  作者: 教師姓名
  日期: 2025-11-11
  說明: 本實作採用增量累加法，避免重複計算並提升效能，同時符合題目輸出格式與精度要求。
*/

public class LeibnizPi {

    public static void main(String[] args) {
        double sum = 0.0;
        int maxN = 100000; // 前 100000 項
        // Part (a): 逐步累加至 100000 項，分別輸出每一萬項的近似值
        for (int k = 0; k < maxN; k++) {
            sum += ((k % 2 == 0) ? 1.0 : -1.0) / (2.0 * k + 1.0);
            int iVal = k + 1;
            if (iVal % 10000 == 0) {
                double pi = sum * 4.0;
                System.out.printf("i = %6d, pi = %.10f%n", iVal, pi);
            }
        }

        // Part (b): 找到最小的 i，使 pi 四捨五入至小數點後 5 位等於 3.14159
        double target = 3.14159;
        int k = maxN;
        while (true) {
            sum += ((k % 2 == 0) ? 1.0 : -1.0) / (2.0 * k + 1.0);
            int iVal = k + 1;
            double pi = sum * 4.0;
            // 以絕對誤差閾值判斷近似是否落在 3.14159 的四捨五入範圍內
            if (Math.abs(pi - target) < 0.000005) {
                System.out.printf("i = %d, pi = %.10f%n", iVal, pi);
                break;
            }
            k++;
        }
    }
}

修改原因要點:
- 將原先的 i <= n 錯誤改為以 k 循序累加 n 項，確保 i 值對應正確的項數（i = k+1）。
- 改為增量式累加，避免每次重新計算整個和，提升效率，適合尋找最小 i 的情境。
- 輸出格式調整為符合題目要求，包括 i 的寬度與 pi 的精度。
- 增加檔案註解，符合「程式標頭註解」的要求。

改進建議或反饋（一句話）
建議在浮點比較時總是採用絕對誤差閾值判斷，避免等於比較帶來的浮點不穩定，並在需要時使用更精確的資料型別或容錯機制以提升穩健性。
